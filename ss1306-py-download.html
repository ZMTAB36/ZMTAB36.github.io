<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta charset="utf-8">
		<title>micropython驱动oled-esp32ssd1306屏驱动ssd1306.py代码下载</title>
		<style>
	     body{ background-color: whitesmoke;}
		 h3{margin:0px 350px;}
		 h3 li a{text-decoration:none; color: coral;}
		.con{ margin:20px 350px; width:55%; background-color: white;}	
		.tit{ margin:10px 10px; border-bottom:1px solid #CCCCCC ; border-top:15px;}
		.tit h1{font-size:22px; color: dimgray;}
		.txt{ margin:10px 10px; margin-bottom:80px; font-size:16px;color: dimgrey;word-wrap: break-word;}
		
		@media screen and (max-width: 600px) {
		h3{margin:0px;  text-decoration:none; color: coral;}
		h3 li a{text-decoration:none; color: coral;}
		.con{ margin:0px; width: 100%; border-bottom:1px solid #CCCCCC ;dimgrey;word-wrap: break-word;}
		
		}
		
		</style>
	</head>
	<body>
		<h3><li><a href=" https://zmtab36.github.io/">返回首页</a></li><br></h3>
		<div class="con">
			<div class="tit"><h1>micropython驱动oled-esp32ssd1306屏驱动ssd1306.py代码下载</h1></div>
			<div class="txt"><p><span style="text-wrap: nowrap;"># 复制以下代码到esp32,新建文件名为：ssd1306.py</span></p><p><span style="text-wrap: nowrap;">#复制文件</span><span style="text-wrap: nowrap; color: rgb(0, 176, 240);"><a href="https://zmtab36.github.io/mian-py.html" target="_self">main.py</a></span><span style="text-wrap: nowrap;">的内容，屏幕输出显示代码，新建名为：mian.py</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">from micropython import const</span></p><p><span style="text-wrap: nowrap;">import framebuf</span></p><p><span style="text-wrap: nowrap;"># register definitions</span></p><p><span style="text-wrap: nowrap;">SET_CONTRAST = const(0x81)</span></p><p><span style="text-wrap: nowrap;">SET_ENTIRE_ON = const(0xA4)</span></p><p><span style="text-wrap: nowrap;">SET_NORM_INV = const(0xA6)</span></p><p><span style="text-wrap: nowrap;">SET_DISP = const(0xAE)</span></p><p><span style="text-wrap: nowrap;">SET_MEM_ADDR = const(0x20)</span></p><p><span style="text-wrap: nowrap;">SET_COL_ADDR = const(0x21)</span></p><p><span style="text-wrap: nowrap;">SET_PAGE_ADDR = const(0x22)</span></p><p><span style="text-wrap: nowrap;">SET_DISP_START_LINE = const(0x40)</span></p><p><span style="text-wrap: nowrap;">SET_SEG_REMAP = const(0xA0)</span></p><p><span style="text-wrap: nowrap;">SET_MUX_RATIO = const(0xA8)</span></p><p><span style="text-wrap: nowrap;">SET_COM_OUT_DIR = const(0xC0)</span></p><p><span style="text-wrap: nowrap;">SET_DISP_OFFSET = const(0xD3)</span></p><p><span style="text-wrap: nowrap;">SET_COM_PIN_CFG = const(0xDA)</span></p><p><span style="text-wrap: nowrap;">SET_DISP_CLK_DIV = const(0xD5)</span></p><p><span style="text-wrap: nowrap;">SET_PRECHARGE = const(0xD9)</span></p><p><span style="text-wrap: nowrap;">SET_VCOM_DESEL = const(0xDB)</span></p><p><span style="text-wrap: nowrap;">SET_CHARGE_PUMP = const(0x8D)</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;"># Subclassing FrameBuffer provides support for graphics primitives</span></p><p><span style="text-wrap: nowrap;"># http://docs.micropython.org/en/latest/pyboard/library/framebuf.html</span></p><p><span style="text-wrap: nowrap;">class SSD1306(framebuf.FrameBuffer):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def __init__(self, width, height, external_vcc):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.width = width</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.height = height</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.external_vcc = external_vcc</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.pages = self.height // 8</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.buffer = bytearray(self.pages * self.width)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; super().__init__(self.buffer, self.width, self.height, framebuf.MONO_VLSB)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.init_display()</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def init_display(self):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; for cmd in (</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_DISP | 0x00,&nbsp; # off</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # address setting</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_MEM_ADDR,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x00,&nbsp; # horizontal</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # resolution and layout</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_DISP_START_LINE | 0x00,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_SEG_REMAP | 0x01,&nbsp; # column addr 127 mapped to SEG0</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_MUX_RATIO,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.height - 1,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_COM_OUT_DIR | 0x08,&nbsp; # scan from COM[N] to COM0</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_DISP_OFFSET,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x00,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_COM_PIN_CFG,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x02 if self.width &gt; 2 * self.height else 0x12,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # timing and driving scheme</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_DISP_CLK_DIV,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_PRECHARGE,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x22 if self.external_vcc else 0xF1,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_VCOM_DESEL,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x30,&nbsp; # 0.83*Vcc</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # display</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_CONTRAST,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0xFF,&nbsp; # maximum</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_ENTIRE_ON,&nbsp; # output follows RAM contents</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_NORM_INV,&nbsp; # not inverted</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # charge pump</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_CHARGE_PUMP,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x10 if self.external_vcc else 0x14,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET_DISP | 0x01,</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; ):&nbsp; # on</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(cmd)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.fill(0)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.show()</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def poweroff(self):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(SET_DISP | 0x00)</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def poweron(self):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(SET_DISP | 0x01)</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def contrast(self, contrast):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(SET_CONTRAST)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(contrast)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp;&nbsp;</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def rotate(self, rotate):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(SET_COM_OUT_DIR | ((rotate &amp; 1) &lt;&lt; 3))</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(SET_SEG_REMAP | (rotate &amp; 1))</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def invert(self, invert):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(SET_NORM_INV | (invert &amp; 1))</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def show(self):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; x0 = 0</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; x1 = self.width - 1</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; if self.width == 64:</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # displays with width of 64 pixels are shifted by 32</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x0 += 32</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x1 += 32</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(SET_COL_ADDR)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(x0)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(x1)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(SET_PAGE_ADDR)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(0)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_cmd(self.pages - 1)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_data(self.buffer)</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">class SSD1306_I2C(SSD1306):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def __init__(self, width, height, i2c, addr=0x3C, external_vcc=False):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.i2c = i2c</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.addr = addr</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.temp = bytearray(2)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_list = [b&quot;\x40&quot;, None]&nbsp; # Co=0, D/C#=1</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; super().__init__(width, height, external_vcc)</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def write_cmd(self, cmd):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.temp[0] = 0x80&nbsp; # Co=1, D/C#=0</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.temp[1] = cmd</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.i2c.writeto(self.addr, self.temp)</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def write_data(self, buf):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.write_list[1] = buf</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.i2c.writevto(self.addr, self.write_list)</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">class SSD1306_SPI(SSD1306):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def __init__(self, width, height, spi, dc, res, cs, external_vcc=False):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.rate = 10 * 1024 * 1024</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; dc.init(dc.OUT, value=0)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; res.init(res.OUT, value=0)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; cs.init(cs.OUT, value=1)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.spi = spi</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.dc = dc</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.res = res</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.cs = cs</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; import time</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.res(1)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; time.sleep_ms(1)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.res(0)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; time.sleep_ms(10)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.res(1)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; super().__init__(width, height, external_vcc)</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def write_cmd(self, cmd):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.spi.init(baudrate=self.rate, polarity=0, phase=0)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.cs(1)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.dc(0)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.cs(0)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.spi.write(bytearray([cmd]))</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.cs(1)</span></p><p><span style="text-wrap: nowrap;"><br/></span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; def write_data(self, buf):</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.spi.init(baudrate=self.rate, polarity=0, phase=0)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.cs(1)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.dc(1)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.cs(0)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.spi.write(buf)</span></p><p><span style="text-wrap: nowrap;">&nbsp; &nbsp; &nbsp; &nbsp; self.cs(1)</span></p><p><br/></p></div>
			
		</div>
	</body>
</html>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8c671a94f344a2df44601ff884da0985";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>